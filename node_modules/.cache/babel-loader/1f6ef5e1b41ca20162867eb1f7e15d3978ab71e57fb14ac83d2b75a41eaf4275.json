{"ast":null,"code":"import mockData from './mock-data';\n\n/**\r\n *\r\n * @param {*} events:\r\n * The following function should be in the “api.js” file.\r\n * This function takes an events array, then uses map to create a new array with only locations.\r\n * It will also remove all duplicates by creating another new array using the spread operator and spreading a Set.\r\n * The Set will remove all duplicates from the array.\r\n */\nexport const extractLocations = events => {\n  const extractedLocations = events.map(event => event.location);\n  const locations = [...new Set(extractedLocations)];\n  return locations;\n};\n\n// checkToken function\nconst checkToken = async accessToken => {\n  const response = await fetch(`https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=${accessToken}`);\n  const result = await response.json();\n  return result;\n};\n\n// removeQuery function\nconst removeQuery = () => {\n  let newurl;\n  if (window.history.pushState && window.location.pathname) {\n    newurl = window.location.protocol + \"//\" + window.location.host + window.location.pathname;\n    window.history.pushState(\"\", \"\", newurl);\n  } else {\n    newurl = window.location.protocol + \"//\" + window.location.host;\n    window.history.pushState(\"\", \"\", newurl);\n  }\n};\n\n// getToken  function\nconst getToken = async code => {\n  const encodeCode = encodeURIComponent(code);\n  const response = await fetch('https://9l2n3s5udh.execute-api.eu-central-1.amazonaws.com/dev/api/token' + '/' + encodeCode);\n  const {\n    access_token\n  } = await response.json();\n  access_token && localStorage.setItem(\"access_token\", access_token);\n  return access_token;\n};\n\n// This function will fetch the list of all events\nexport const getEvents = async () => {\n  if (window.location.href.startsWith('http://localhost')) {\n    return mockData;\n  }\n  const token = await getAccessToken();\n  if (token) {\n    removeQuery();\n    const url = \"https://9l2n3s5udh.execute-api.eu-central-1.amazonaws.com/dev/api/get-events\" + \"/\" + token;\n    const response = await fetch(url);\n    const result = await response.json();\n    if (result) {\n      return result.events;\n    } else return null;\n  }\n};\n\n// Getting the Access Token\nexport const getAccessToken = async () => {\n  const accessToken = localStorage.getItem('access_token');\n  const tokenCheck = accessToken && (await checkToken(accessToken));\n  if (!accessToken || tokenCheck.error) {\n    await localStorage.removeItem(\"access_token\");\n    const searchParams = new URLSearchParams(window.location.search);\n    const code = await searchParams.get(\"code\");\n    if (!code) {\n      const response = await fetch(\"https://9l2n3s5udh.execute-api.eu-central-1.amazonaws.com/dev/api/get-auth-url\");\n      const result = await response.json();\n      const {\n        authURL\n      } = result;\n      return window.location.href = authURL;\n    }\n    return code && getToken(code);\n  }\n  return accessToken;\n};","map":{"version":3,"names":["mockData","extractLocations","events","extractedLocations","map","event","location","locations","Set","checkToken","accessToken","response","fetch","result","json","removeQuery","newurl","window","history","pushState","pathname","protocol","host","getToken","code","encodeCode","encodeURIComponent","access_token","localStorage","setItem","getEvents","href","startsWith","token","getAccessToken","url","getItem","tokenCheck","error","removeItem","searchParams","URLSearchParams","search","get","authURL"],"sources":["C:/Isabel/Boot Camp/Full Stack Immersion/meet/src/api.js"],"sourcesContent":["import mockData from './mock-data';\r\n\r\n/**\r\n *\r\n * @param {*} events:\r\n * The following function should be in the “api.js” file.\r\n * This function takes an events array, then uses map to create a new array with only locations.\r\n * It will also remove all duplicates by creating another new array using the spread operator and spreading a Set.\r\n * The Set will remove all duplicates from the array.\r\n */\r\nexport const extractLocations = (events) => {\r\n  const extractedLocations = events.map((event) => event.location);\r\n  const locations = [...new Set(extractedLocations)];\r\n  return locations;\r\n};\r\n\r\n// checkToken function\r\nconst checkToken = async (accessToken) => {\r\n  const response = await fetch(\r\n    `https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=${accessToken}`\r\n  );\r\n  const result = await response.json();\r\n  return result;\r\n};\r\n\r\n// removeQuery function\r\nconst removeQuery = () => {\r\n  let newurl;\r\n  if (window.history.pushState && window.location.pathname) {\r\n    newurl = \r\n      window.location.protocol +\r\n      \"//\" +\r\n      window.location.host +\r\n      window.location.pathname;\r\n    window.history.pushState(\"\", \"\", newurl);\r\n  } else {\r\n    newurl = window.location.protocol + \"//\" + window.location.host;\r\n    window.history.pushState(\"\", \"\", newurl);\r\n  }\r\n};\r\n\r\n// getToken  function\r\nconst getToken = async (code) => {\r\n  const encodeCode = encodeURIComponent(code);\r\n  const response = await fetch(\r\n    'https://9l2n3s5udh.execute-api.eu-central-1.amazonaws.com/dev/api/token' + '/' + encodeCode\r\n  );\r\n  const { access_token } = await response.json();\r\n  access_token && localStorage.setItem(\"access_token\", access_token);\r\n\r\n  return access_token;\r\n};\r\n\r\n// This function will fetch the list of all events\r\nexport const getEvents = async () => {\r\n  if (window.location.href.startsWith('http://localhost')) {\r\n    return mockData;\r\n  }\r\n\r\n  const token = await getAccessToken();\r\n\r\n  if (token) {\r\n    removeQuery();\r\n    const url = \"https://9l2n3s5udh.execute-api.eu-central-1.amazonaws.com/dev/api/get-events\" + \"/\" + token;\r\n    const response = await fetch(url);\r\n    const result = await response.json();\r\n    if (result) {\r\n      return result.events;\r\n    } else return null;\r\n  }\r\n};\r\n\r\n// Getting the Access Token\r\nexport const getAccessToken = async () => {\r\n  const accessToken = localStorage.getItem('access_token');\r\n\r\n  const tokenCheck = accessToken && (await checkToken(accessToken));\r\n\r\n  if (!accessToken || tokenCheck.error) {\r\n    await localStorage.removeItem(\"access_token\");\r\n    const searchParams = new URLSearchParams(window.location.search);\r\n    const code = await searchParams.get(\"code\");\r\n    if (!code) {\r\n      const response = await fetch(\r\n        \"https://9l2n3s5udh.execute-api.eu-central-1.amazonaws.com/dev/api/get-auth-url\"\r\n      );\r\n      const result = await response.json();\r\n      const { authURL } = result;\r\n      return (window.location.href = authURL);\r\n    }\r\n    return code && getToken(code);\r\n  }\r\n  return accessToken\r\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}